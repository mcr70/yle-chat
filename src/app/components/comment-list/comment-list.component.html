<div class="main-layout-container">
    
  <div class="sidebar">
    <app-login-panel></app-login-panel>

    <app-my-discussions
      (discussionSelected)="handleDiscussionSelected($event)"      (articleIdFilterChange)="onArticleIdChanged($event)">
    </app-my-discussions>

    <app-history-list 
        [articleIdFilter]="articleId"
        (articleIdFilterChange)="onArticleIdChanged($event)"
        (articleSelected)="handleArticleSelected($event)">
    </app-history-list>
  </div>

  <div class="comment-section">
    <div class="comment-container">
        <h3>{{ articleTitle || articleId }}</h3>        

        <div class="filter-controls">
            <div class="filter-row">
                <button 
                  (click)="loadComments(true)" 
                  [disabled]="isLoading"
                  class="refresh-button"
                  title="{{ isLoading ? 'Ladataan...' : 'PÃ¤ivitÃ¤ kommentit' }}">
                  
                  <span *ngIf="!isLoading">ðŸ”„</span> <span *ngIf="isLoading" class="spinner">â†»</span> 
                </button>

                <input
                    type="text"
                    placeholder="Suodata nimimerkillÃ¤..."
                    [value]="nicknameFilter"
                    (input)="onNicknameChanged($any($event.target).value)"
                    class="filter-input"
                />

                <div class="hide-control">
                    <input 
                        type="checkbox" 
                        id="hideUnmarked" 
                        [checked]="hideUnmarkedTopLevel"
                        (change)="hideUnmarkedTopLevel = $any($event.target).checked"
                        
                        [disabled]="!isHideUnmarkedEnabled" 
                    >
                    <label 
                        for="hideUnmarked"
                        [class.disabled-label]="!isHideUnmarkedEnabled">Piilota muut</label>
                </div>
            </div>
        </div>
        
      <hr>

      <ng-container *ngIf="comments.length > 0; else noComments">
        <app-comment-item 
          *ngFor="let comment of filteredComments" 
          [comment]="comment"
          [level]="0">
        </app-comment-item>

        <div class="load-more-container" *ngIf="hasMoreComments">
        <button 
            (click)="loadMoreComments()" 
            [disabled]="isLoading" 
            class="load-more-button">
            {{ isLoading ? 'Ladataan...' : 'Lataa lisÃ¤Ã¤ kommentteja' }}
        </button>
        </div>    
      </ng-container>

      <ng-template #noComments>
        <p>Ei kommentteja.</p>
      </ng-template>

    </div>
  </div>
</div>